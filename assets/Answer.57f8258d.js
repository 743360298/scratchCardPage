import{_ as e}from"./AnswerOption.d7cbb6d1.js";import{o as s,a as t,f as n,M as o,N as i,U as a,e as r,O as u,D as h,b as l,Q as c,L as d}from"./vendor.24e2e329.js";import{g as w,a as g}from"./web-quetison.0cde22e4.js";const p={name:"AnswerDialog",props:{value:Boolean,questions:{type:Array,default:()=>[]}},watch:{value:{deep:!0,header(e){this.showDialog=e}}},data:()=>({showDialog:!1}),methods:{goItemAnswer(e){this.$emit("gointo",e)},confirm(){this.$emit("click",this.showDialog)},cancel(){this.$emit("click",this.showDialog)}}},m=a(),f=m(((e,a,h,l,c,d)=>{const w=r("van-icon"),g=r("VanGridItem"),p=r("VanGrid"),f=r("VanDialog");return s(),t(f,{show:c.showDialog,"onUpdate:show":a[1]||(a[1]=e=>c.showDialog=e),title:"",key:Date.now(),onConfirm:d.confirm,onCancel:d.cancel,confirmButtonText:"取消","close-on-click-overlay":!0},{default:m((()=>[n(p,{"column-num":3},{default:m((()=>[(s(!0),t(o,null,i(h.questions,((e,i)=>(s(),t(o,null,[e.answer?(s(),t(g,{key:i,text:`${i+1}：${e.answer} ${e.correctAnswer}`,onClick:e=>d.goItemAnswer(i)},{icon:m((()=>[n(w,{name:e.answer===e.correctAnswer||e.answer===e.correctAnswer2?"success":"cross"},null,8,["name"])])),_:2},1032,["text","onClick"])):u("",!0)],64)))),256))])),_:1})])),_:1},8,["show","onConfirm","onCancel"])}));p.render=f,p.__scopeId="data-v-32788cf4";const q={name:"Answer",components:{AnswerOption:e,AnswerDialog:p},props:{questionBankType:String},data:()=>({showDialog:!1,userInfo:{},questions:[],questionBank:w(),questionIndex:0}),computed:{progressAnswer(){return 100/this.questions.length*(this.questionIndex+1)},questionBankType(){return this.questionBank.find((e=>e.id===Number(this.questionBankType))).name}},mounted(){},created(){this.userInfo=JSON.parse(sessionStorage.getItem("user-info")),sessionStorage.getItem("questions")?this.questions=JSON.parse(sessionStorage.getItem("questions")):this.questions=g();let e=this.questions.findIndex((e=>!e.answer));-1===e&&(e=this.questions.length-1),this.questionIndex=e},methods:{getAnswerItem(e){this.questions[this.questionIndex].answer=e},onClickBack(){this.questions[0].answer?h.confirm({title:"提示",message:"返回后将重新答题，是否继续？"}).then((()=>{sessionStorage.removeItem("questions"),sessionStorage.removeItem("user-info"),sessionStorage.removeItem("qr-code"),this.$router?this.$router.back():window.history.back()})).catch((()=>{})):this.$router?this.$router.back():window.history.back()},prevBtn(){this.$refs.swipeIndex.prev()},nextBtn(){this.questions[this.questionIndex].answer?this.$refs.swipeIndex.next():this.$toast("请选择当前题目才能跳转下一题")},onChange(e){this.questionIndex=e},viewAnswerBtn(){this.showDialog=!0},gointo(e){this.questionIndex=e,this.showDialog=!1},submitBtn(){sessionStorage.setItem("questions",JSON.stringify(this.questions)),this.$router.push({path:"/viewAnswer"})},getQRCode(){let e=[];e=this.questions.map((e=>e.answer));const s={name:this.userInfo.name,cardType:"101",card:this.userInfo.card,birth:this.changeBirth(this.userInfo.card),nation:this.userInfo.nation,sex:this.userInfo.sex,isReport:"",createdTime:this.getDate(),mobile:this.userInfo.mobile,contactAddress:"",answer:e.join(""),forPeople:this.forPeople},t=[];for(const n in s){const e=s[n];t.push(e)}return t.join("!")},changeBirth(e){const s=/\d{6}([12]\d{3})([01]\d)([0123]\d)\d{4}/.exec(e);return`${s[1]}-${s[2]}-${s[3]}`},getDate(){const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}-${e.getDate()<10?`0${e.getDate()}`:e.getDate()}`}}},I=c("答题进度："),k={class:"subject"},x={class:"btn-list"},y=c("上一题"),D=c("下一题"),$=c("提交");q.render=function(e,a,u,h,w,g){const p=r("VanCol"),m=r("VanProgress"),f=r("VanRow"),q=r("AnswerOption"),A=r("VanSwipeItem"),b=r("VanSwipe"),v=r("VanButton"),B=r("AnswerDialog"),C=r("Page");return s(),t(C,{"content-class":"answer",header:"",footer:"",title:`${g.questionBankType}从入门到放弃`},{default:l((()=>[n(f,{class:"progress-answer-row"},{default:l((()=>[n(p,{span:"5",class:"progress-answer-item"},{default:l((()=>[I])),_:1}),n(p,{span:"14",class:"progress-answer"},{default:l((()=>[n(m,{percentage:g.progressAnswer,"stroke-width":"8","show-pivot":!1},null,8,["percentage"])])),_:1}),n(p,{span:"5",class:"progress-answer-item"},{default:l((()=>[c(d(w.questionIndex+1)+" / "+d(w.questions.length),1)])),_:1})])),_:1}),n(b,{onChange:g.onChange,"initial-swipe":w.questionIndex,"indicator-color":"white",touchable:!1,"show-indicators":!1,loop:!1,ref:"swipeIndex"},{default:l((()=>[(s(!0),t(o,null,i(w.questions,((e,o)=>(s(),t(A,{key:o},{default:l((()=>[n("div",k,d(w.questionIndex+1)+"、"+d(e.name)+d(""+("check"===e.type?"（多选）":"")),1),n(q,{value:e.answer,onChange:g.getAnswerItem,options:e.options,type:e.type},null,8,["value","onChange","options","type"])])),_:2},1024)))),128))])),_:1},8,["onChange","initial-swipe"]),n("div",x,[n(v,{type:"primary",onClick:a[1]||(a[1]=e=>g.prevBtn()),disabled:0===w.questionIndex},{default:l((()=>[y])),_:1},8,["disabled"]),w.questionIndex+1!==w.questions.length?(s(),t(v,{key:0,type:"primary",onClick:a[2]||(a[2]=e=>g.nextBtn())},{default:l((()=>[D])),_:1})):(s(),t(v,{key:1,type:"primary",onClick:a[3]||(a[3]=e=>g.submitBtn())},{default:l((()=>[$])),_:1}))]),n(B,{show:w.showDialog,"onUpdate:show":a[4]||(a[4]=e=>w.showDialog=e),questions:w.questions,onGointo:g.gointo},null,8,["show","questions","onGointo"])])),_:1},8,["title"])};export default q;
